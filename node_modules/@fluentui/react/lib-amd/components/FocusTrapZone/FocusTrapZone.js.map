{"version":3,"file":"FocusTrapZone.js","sourceRoot":"../src/","sources":["components/FocusTrapZone/FocusTrapZone.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  elementContains,\n  getNativeProps,\n  divProperties,\n  getFirstTabbable,\n  getLastTabbable,\n  getNextElement,\n  focusAsync,\n  modalize,\n  on,\n} from '../../Utilities';\nimport { useId, useConst, useMergedRefs, useUnmount } from '@fluentui/react-hooks';\nimport { useDocument } from '../../WindowProvider';\nimport type { IRefObject } from '../../Utilities';\nimport type { IFocusTrapZoneProps, IFocusTrapZone } from './FocusTrapZone.types';\n\ninterface IFocusTrapZoneInternalState {\n  disposeFocusHandler: (() => void) | undefined;\n  disposeClickHandler: (() => void) | undefined;\n  previouslyFocusedElementOutsideTrapZone: HTMLElement | undefined;\n  previouslyFocusedElementInTrapZone: HTMLElement | undefined;\n  hasFocus: boolean;\n  unmodalize: (() => void) | undefined;\n}\n\nconst COMPONENT_NAME = 'FocusTrapZone';\n\nconst useComponentRef = (\n  componentRef: IRefObject<IFocusTrapZone> | undefined,\n  previouslyFocusedElement: HTMLElement | undefined,\n  focus: () => void,\n) => {\n  React.useImperativeHandle(\n    componentRef,\n    () => ({\n      get previouslyFocusedElement() {\n        return previouslyFocusedElement;\n      },\n      focus,\n    }),\n    [previouslyFocusedElement, focus],\n  );\n};\n\nexport const FocusTrapZone: React.FunctionComponent<IFocusTrapZoneProps> & {\n  focusStack: string[];\n} = React.forwardRef<HTMLElement, IFocusTrapZoneProps>((props, ref) => {\n  const root = React.useRef<HTMLDivElement>(null);\n  const firstBumper = React.useRef<HTMLDivElement>(null);\n  const lastBumper = React.useRef<HTMLDivElement>(null);\n  const mergedRootRef = useMergedRefs(root, ref) as React.Ref<HTMLDivElement>;\n  const id = useId(undefined, props.id);\n  const doc = useDocument();\n  const divProps = getNativeProps<React.HTMLAttributes<HTMLDivElement>>(props, divProperties);\n\n  const internalState = useConst<IFocusTrapZoneInternalState>(() => ({\n    previouslyFocusedElementOutsideTrapZone: undefined,\n    previouslyFocusedElementInTrapZone: undefined,\n    disposeFocusHandler: undefined,\n    disposeClickHandler: undefined,\n    hasFocus: false,\n    unmodalize: undefined,\n  }));\n\n  const {\n    ariaLabelledBy,\n    className,\n    children,\n    componentRef,\n    disabled,\n    disableFirstFocus = false,\n    disabled: currentDisabledValue = false,\n    elementToFocusOnDismiss,\n    forceFocusInsideTrap = true,\n    focusPreviouslyFocusedInnerElement,\n    // eslint-disable-next-line deprecation/deprecation\n    firstFocusableSelector,\n    firstFocusableTarget,\n    ignoreExternalFocusing,\n    isClickableOutsideFocusTrap = false,\n    onFocus,\n    onBlur,\n    onFocusCapture,\n    onBlurCapture,\n    enableAriaHiddenSiblings,\n  } = props;\n\n  const bumperProps = {\n    'aria-hidden': true,\n    style: {\n      pointerEvents: 'none',\n      position: 'fixed', // 'fixed' prevents browsers from scrolling to bumpers when viewport does not contain them\n    },\n    tabIndex: disabled ? -1 : 0, // make bumpers tabbable only when enabled\n    'data-is-visible': true,\n    'data-is-focus-trap-zone-bumper': true,\n  } as React.HTMLAttributes<HTMLDivElement>;\n\n  const focus = React.useCallback(() => {\n    if (\n      focusPreviouslyFocusedInnerElement &&\n      internalState.previouslyFocusedElementInTrapZone &&\n      elementContains(root.current, internalState.previouslyFocusedElementInTrapZone)\n    ) {\n      // focus on the last item that had focus in the zone before we left the zone\n      focusAsync(internalState.previouslyFocusedElementInTrapZone);\n      return;\n    }\n\n    const focusSelector =\n      typeof firstFocusableSelector === 'string'\n        ? firstFocusableSelector\n        : firstFocusableSelector && firstFocusableSelector();\n\n    let firstFocusableChild: HTMLElement | null = null;\n\n    if (root.current) {\n      if (typeof firstFocusableTarget === 'string') {\n        firstFocusableChild = root.current.querySelector(firstFocusableTarget);\n      } else if (firstFocusableTarget) {\n        firstFocusableChild = firstFocusableTarget(root.current);\n      } else if (focusSelector) {\n        firstFocusableChild = root.current.querySelector('.' + focusSelector);\n      }\n\n      // Fall back to first element if query selector did not match any elements.\n      if (!firstFocusableChild) {\n        firstFocusableChild = getNextElement(\n          root.current,\n          root.current.firstChild as HTMLElement,\n          false,\n          false,\n          false,\n          true,\n        );\n      }\n    }\n    if (firstFocusableChild) {\n      focusAsync(firstFocusableChild);\n    }\n  }, [firstFocusableSelector, firstFocusableTarget, focusPreviouslyFocusedInnerElement, internalState]);\n\n  const onBumperFocus = React.useCallback(\n    (isFirstBumper: boolean) => {\n      if (disabled) {\n        return;\n      }\n\n      const currentBumper = (isFirstBumper === internalState.hasFocus\n        ? lastBumper.current\n        : firstBumper.current) as HTMLElement;\n\n      if (root.current) {\n        const nextFocusable =\n          isFirstBumper === internalState.hasFocus\n            ? getLastTabbable(root.current, currentBumper, true, false)\n            : getFirstTabbable(root.current, currentBumper, true, false);\n\n        if (nextFocusable) {\n          if (nextFocusable === firstBumper.current || nextFocusable === lastBumper.current) {\n            // This can happen when FTZ contains no tabbable elements.\n            // focus will take care of finding a focusable element in FTZ.\n            focus();\n          } else {\n            nextFocusable.focus();\n          }\n        }\n      }\n    },\n    [disabled, focus, internalState],\n  );\n\n  const onRootBlurCapture = React.useCallback(\n    (ev: React.FocusEvent<HTMLDivElement>) => {\n      onBlurCapture?.(ev);\n      let relatedTarget = ev.relatedTarget;\n      if (ev.relatedTarget === null) {\n        // In IE11, due to lack of support, event.relatedTarget is always\n        // null making every onBlur call to be \"outside\" of the root\n        // even when it's not. Using document.activeElement is another way\n        // for us to be able to get what the relatedTarget without relying\n        // on the event\n        relatedTarget = doc!.activeElement as Element;\n      }\n      if (!elementContains(root.current, relatedTarget as HTMLElement)) {\n        internalState.hasFocus = false;\n      }\n    },\n    [doc, internalState, onBlurCapture],\n  );\n\n  const onRootFocusCapture = React.useCallback(\n    (ev: React.FocusEvent<HTMLDivElement>) => {\n      onFocusCapture?.(ev);\n\n      if (ev.target === firstBumper.current) {\n        onBumperFocus(true);\n      } else if (ev.target === lastBumper.current) {\n        onBumperFocus(false);\n      }\n\n      internalState.hasFocus = true;\n\n      if (ev.target !== ev.currentTarget && !(ev.target === firstBumper.current || ev.target === lastBumper.current)) {\n        // every time focus changes within the trap zone, remember the focused element so that\n        // it can be restored if focus leaves the pane and returns via keystroke (i.e. via a call to this.focus(true))\n        internalState.previouslyFocusedElementInTrapZone = ev.target as HTMLElement;\n      }\n    },\n    [onFocusCapture, internalState, onBumperFocus],\n  );\n\n  const returnFocusToInitiator = React.useCallback((): void => {\n    FocusTrapZone.focusStack = FocusTrapZone.focusStack.filter((value: any) => {\n      return id !== value;\n    });\n\n    if (doc) {\n      const activeElement = doc.activeElement as HTMLElement;\n      if (\n        !ignoreExternalFocusing &&\n        internalState.previouslyFocusedElementOutsideTrapZone &&\n        typeof internalState.previouslyFocusedElementOutsideTrapZone.focus === 'function' &&\n        (elementContains(root.current, activeElement) || activeElement === doc.body)\n      ) {\n        if (\n          !(\n            internalState.previouslyFocusedElementOutsideTrapZone === firstBumper.current ||\n            internalState.previouslyFocusedElementOutsideTrapZone === lastBumper.current\n          )\n        ) {\n          focusAsync(internalState.previouslyFocusedElementOutsideTrapZone);\n        }\n      }\n    }\n  }, [doc, id, ignoreExternalFocusing, internalState]);\n\n  const forceFocusInTrap = React.useCallback(\n    (ev: FocusEvent): void => {\n      if (disabled) {\n        return;\n      }\n      if (FocusTrapZone.focusStack.length && id === FocusTrapZone.focusStack[FocusTrapZone.focusStack.length - 1]) {\n        const focusedElement = ev.target as HTMLElement;\n        if (!elementContains(root.current, focusedElement)) {\n          focus();\n          internalState.hasFocus = true; // set focus here since we stop event propagation\n          ev.preventDefault();\n          ev.stopPropagation();\n        }\n      }\n    },\n    [disabled, id, focus, internalState],\n  );\n\n  const forceClickInTrap = React.useCallback(\n    (ev: MouseEvent): void => {\n      if (disabled) {\n        return;\n      }\n      if (FocusTrapZone.focusStack.length && id === FocusTrapZone.focusStack[FocusTrapZone.focusStack.length - 1]) {\n        const clickedElement = ev.target as HTMLElement;\n        if (clickedElement && !elementContains(root.current, clickedElement)) {\n          focus();\n          internalState.hasFocus = true; // set focus here since we stop event propagation\n          ev.preventDefault();\n          ev.stopPropagation();\n        }\n      }\n    },\n    [disabled, id, focus, internalState],\n  );\n\n  const updateEventHandlers = React.useCallback((): void => {\n    if (forceFocusInsideTrap && !internalState.disposeFocusHandler) {\n      internalState.disposeFocusHandler = on(window, 'focus', forceFocusInTrap, true);\n    } else if (!forceFocusInsideTrap && internalState.disposeFocusHandler) {\n      internalState.disposeFocusHandler();\n      internalState.disposeFocusHandler = undefined;\n    }\n\n    if (!isClickableOutsideFocusTrap && !internalState.disposeClickHandler) {\n      internalState.disposeClickHandler = on(window, 'click', forceClickInTrap, true);\n    } else if (isClickableOutsideFocusTrap && internalState.disposeClickHandler) {\n      internalState.disposeClickHandler();\n      internalState.disposeClickHandler = undefined;\n    }\n  }, [forceClickInTrap, forceFocusInTrap, forceFocusInsideTrap, isClickableOutsideFocusTrap, internalState]);\n\n  // Updates eventHandlers and cleans up focusStack when the component unmounts.\n  React.useEffect(() => {\n    const parentRoot = root.current;\n    updateEventHandlers();\n    return () => {\n      // don't handle return focus unless forceFocusInsideTrap is true or focus is still within FocusTrapZone\n      if (!disabled || forceFocusInsideTrap || !elementContains(parentRoot, doc?.activeElement as HTMLElement)) {\n        returnFocusToInitiator();\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- Should only run on mount.\n  }, [updateEventHandlers]);\n\n  // Updates focusStack and the previouslyFocusedElementOutsideTrapZone on prop change.\n  React.useEffect(() => {\n    const newForceFocusInsideTrap = forceFocusInsideTrap !== undefined ? forceFocusInsideTrap : true;\n    const newDisabled = disabled !== undefined ? disabled : false;\n\n    // Transition from forceFocusInsideTrap / FTZ disabled to enabled.\n    if (!newDisabled || newForceFocusInsideTrap) {\n      if (currentDisabledValue) {\n        return;\n      }\n\n      FocusTrapZone.focusStack.push(id);\n\n      internalState.previouslyFocusedElementOutsideTrapZone = elementToFocusOnDismiss\n        ? elementToFocusOnDismiss\n        : (doc!.activeElement as HTMLElement);\n      if (!disableFirstFocus && !elementContains(root.current, internalState.previouslyFocusedElementOutsideTrapZone)) {\n        focus();\n      }\n      if (!internalState.unmodalize && root.current && enableAriaHiddenSiblings) {\n        internalState.unmodalize = modalize(root.current);\n      }\n    } else if (!newForceFocusInsideTrap || newDisabled) {\n      // Transition from forceFocusInsideTrap / FTZ enabled to disabled.\n      returnFocusToInitiator();\n      if (internalState.unmodalize) {\n        internalState.unmodalize();\n      }\n    }\n\n    if (elementToFocusOnDismiss && internalState.previouslyFocusedElementOutsideTrapZone !== elementToFocusOnDismiss) {\n      internalState.previouslyFocusedElementOutsideTrapZone = elementToFocusOnDismiss;\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [elementToFocusOnDismiss, forceFocusInsideTrap, disabled]);\n\n  // Cleanup lifecyle method for internalState.\n  useUnmount(() => {\n    // Dispose of event handlers so their closures can be garbage-collected\n    if (internalState.disposeClickHandler) {\n      internalState.disposeClickHandler();\n      internalState.disposeClickHandler = undefined;\n    }\n    if (internalState.disposeFocusHandler) {\n      internalState.disposeFocusHandler();\n      internalState.disposeFocusHandler = undefined;\n    }\n    if (internalState.unmodalize) {\n      internalState.unmodalize();\n    }\n    // Dispose of element references so the DOM Nodes can be garbage-collected\n    delete internalState.previouslyFocusedElementInTrapZone;\n    delete internalState.previouslyFocusedElementOutsideTrapZone;\n  });\n\n  useComponentRef(componentRef, internalState.previouslyFocusedElementInTrapZone, focus);\n\n  return (\n    <div\n      {...divProps}\n      className={className}\n      ref={mergedRootRef}\n      aria-labelledby={ariaLabelledBy}\n      onFocusCapture={onRootFocusCapture}\n      onFocus={onFocus}\n      onBlur={onBlur}\n      onBlurCapture={onRootBlurCapture}\n    >\n      <div {...bumperProps} ref={firstBumper} />\n      {children}\n      <div {...bumperProps} ref={lastBumper} />\n    </div>\n  );\n}) as any;\n\nFocusTrapZone.displayName = COMPONENT_NAME;\nFocusTrapZone.focusStack = [];\n"]}